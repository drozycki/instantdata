import{_ as se}from"../chunks/CmsKOCeN.js";import{t as X,a as R,b as ie}from"../chunks/CScCYyQC.js";import{i as le}from"../chunks/CXMguHLv.js";import{i as fe,h as A,j as oe,g as l,k as Z,H as ue,l as $,n as P,o as H,v as q,w as ve,x as j,y as ee,z as de,I as C,A as ae,B as V,C as ce,D as _e,E as Q,F as pe,G as he,J as me,K as ye,L as ge,M as we,N as Ee,O as be,P as xe,p as Te,f as U,a as ke,Q as E,m as N,s as S,R as Ae,$ as Ie,T as L,U as D,V as O,b as B,t as F}from"../chunks/17LP3wq2.js";import{e as K,s as W}from"../chunks/Cyx6yB1E.js";import{b as Y}from"../chunks/BwpNukmJ.js";import{o as qe,a as De}from"../chunks/BSGqvv92.js";function z(d,e){return e}function Me(d,e,a,c){for(var r=[],f=e.length,s=0;s<f;s++)he(e[s].e,r,!0);var h=f>0&&r.length===0&&a!==null;if(h){var _=a.parentNode;me(_),_.append(a),c.clear(),b(d,e[0].prev,e[f-1].next)}ye(r,()=>{for(var y=0;y<f;y++){var t=e[y];h||(c.delete(t.k),b(d,t.prev,t.next)),ge(t.e,!h)}})}function G(d,e,a,c,r,f=null){var s=d,h={flags:e,items:new Map,first:null};A&&oe();var _=null,y=!1,t=Z(()=>{var u=a();return xe(u)?u:u==null?[]:ae(u)});fe(()=>{var u=l(t),i=u.length;if(y&&i===0)return;y=i===0;let p=!1;if(A){var o=s.data===ue;o!==(i===0)&&(s=$(),P(s),H(!1),p=!0)}if(A){for(var w=null,v,n=0;n<i;n++){if(q.nodeType===8&&q.data===ve){s=q,p=!0,H(!1);break}var m=u[n],x=c(m,n);v=re(q,h,w,null,m,x,n,r,e,a),h.items.set(x,v),w=v}i>0&&P($())}A||Re(u,h,s,r,e,c,a),f!==null&&(i===0?_?j(_):_=ee(()=>f(s)):_!==null&&de(_,()=>{_=null})),p&&H(!0),l(t)}),A&&(s=q)}function Re(d,e,a,c,r,f,s){var h=d.length,_=e.items,y=e.first,t=y,u,i=null,p=[],o=[],w,v,n,m;for(m=0;m<h;m+=1){if(w=d[m],v=f(w,m),n=_.get(v),n===void 0){var x=t?t.e.nodes_start:a;i=re(x,e,i,i===null?e.first:i.next,w,v,m,c,r,s),_.set(v,i),p=[],o=[],t=i.next;continue}if(He(n,w,m),(n.e.f&C)!==0&&j(n.e),n!==t){if(u!==void 0&&u.has(n)){if(p.length<o.length){var T=o[0],g;i=T.prev;var M=p[0],k=p[p.length-1];for(g=0;g<p.length;g+=1)J(p[g],T,a);for(g=0;g<o.length;g+=1)u.delete(o[g]);b(e,M.prev,k.next),b(e,i,M),b(e,k,T),t=T,i=k,m-=1,p=[],o=[]}else u.delete(n),J(n,t,a),b(e,n.prev,n.next),b(e,n,i===null?e.first:i.next),b(e,i,n),i=n;continue}for(p=[],o=[];t!==null&&t.k!==v;)(t.e.f&C)===0&&(u??=new Set).add(t),o.push(t),t=t.next;if(t===null)continue;n=t}p.push(n),i=n,t=n.next}if(t!==null||u!==void 0){for(var I=u===void 0?[]:ae(u);t!==null;)(t.e.f&C)===0&&I.push(t),t=t.next;var te=I.length;if(te>0){var ne=null;Me(e,I,ne,_)}}V.first=e.first&&e.first.e,V.last=i&&i.e}function He(d,e,a,c){ce(d.v,e),d.i=a}function re(d,e,a,c,r,f,s,h,_,y){var t=(_&we)!==0,u=(_&Ee)===0,i=t?u?_e(r):Q(r):r,p=(_&pe)===0?s:Q(s),o={i:p,v:i,k:f,a:null,e:null,prev:a,next:c};try{return o.e=ee(()=>h(d,i,p,y),A),o.e.prev=a&&a.e,o.e.next=c&&c.e,a===null?e.first=o:(a.next=o,a.e.next=o.e),c!==null&&(c.prev=o,c.e.prev=o.e),o}finally{}}function J(d,e,a){for(var c=d.next?d.next.e.nodes_start:a,r=e?e.e.nodes_start:a,f=d.e.nodes_start;f!==c;){var s=be(f);r.before(f),f=s}}function b(d,e,a){e===null?d.first=a:(e.next=a,e.e.next=a&&a.e),a!==null&&(a.prev=e,a.e.prev=e&&e.e)}var Ce=X(` <!>
`,1),Ne=X(`<pre class="text-sm whitespace-pre-wrap"><code><!>
</code>
</pre> <form class="font-mono text-sm fixed bottom-0"><input class="bg-white p-1 border-t-1 w-screen" type="text" placeholder="Enter SQL query"></form>`,1);function Ue(d,e){Te(e,!1);let a,c=N(),r=N(),f=N([]),s=-1,h="";function _(v){l(r).focus(),l(f).length&&(v.key==="ArrowUp"?s===-1?(h=l(r).value,s=l(f).length-1,E(r,l(r).value=l(f)[s]?.query)):s>0&&E(r,l(r).value=l(f)[--s]?.query):v.key==="ArrowDown"&&(s===l(f).length-1?(E(r,l(r).value=h),s=-1):s!==-1&&s<l(f).length-1&&E(r,l(r).value=l(f)[++s]?.query)))}qe(async()=>{if(window?.Worker){const v=await se(()=>import("../chunks/DGm-k8xs.js"),[],import.meta.url);a=new v.default,a.onmessage=async n=>{n.data==="ready"?(E(r,l(r).value="SELECT * FROM sqlite_schema;"),l(c).requestSubmit()):n.data&&(l(f).push({query:l(r).value,result:n.data}),S(f,l(f)),E(r,l(r).value=""),await Ae(),window.scrollTo({top:document.body.scrollHeight,behavior:"instant"}),E(r,l(r).disabled=!1))}}}),De(()=>a?.terminate());async function y(v){E(r,l(r).disabled=!0),s=-1,h="",a?.postMessage(v?.target?.[0]?.value)}le();var t=Ne();K("keydown",Ie,_);var u=U(t),i=L(u),p=L(i);G(p,1,()=>l(f),z,(v,n)=>{D();var m=Ce(),x=U(m),T=B(x);G(T,1,()=>l(n).result,z,(g,M)=>{D();var k=ie();F(I=>W(k,`
${I??""}`),[()=>l(M).join("|")],Z),R(g,k)}),D(),F(()=>W(x,`> ${l(n).query??""}`)),R(v,m)}),D(),O(i),D(),O(u);var o=B(u,2),w=L(o);Y(w,v=>S(r,v),()=>l(r)),O(o),Y(o,v=>S(c,v),()=>l(c)),K("submit",o,y),R(d,t),ke()}export{Ue as component};
